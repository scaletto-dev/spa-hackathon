# Risk Profile: Story 1.1 - Initialize Monorepo with Frontend and Backend Apps

**Date:** October 28, 2025  
**Reviewer:** Quinn (Test Architect)  
**Story:** Epic 1, Story 1.1  
**Overall Risk Score:** 85/100 (Low Risk)

---

## Executive Summary

- **Total Risks Identified:** 7
- **Critical Risks (Score 9):** 0
- **High Risks (Score 6):** 1
- **Medium Risks (Score 4):** 2
- **Low Risks (Score 2-3):** 4
- **Risk Score:** 85/100 - Infrastructure setup with well-established tooling

**Assessment:** Story 1.1 presents **LOW overall risk** appropriate for foundational infrastructure. The one high-risk item (npm version compatibility) has straightforward mitigation. Medium risks involve standard cross-platform and configuration concerns typical of monorepo setups.

**Gate Recommendation:** ✅ **PASS** (conditional on .nvmrc addition and Windows script verification)

---

## High Risks Requiring Attention

### 1. TECH-001: npm Workspaces Version Compatibility

**Score: 6 (High)** | Probability: Medium (2) × Impact: High (3)

**Risk Description:**  
npm workspaces behavior varies between npm versions (particularly <10). Older versions may not hoist dependencies correctly, causing module resolution failures across the monorepo.

**Probability Reasoning:**  
Medium - Developers may have different npm versions installed, especially on existing machines. npm 10 is relatively recent (April 2024).

**Impact Analysis:**  
High - Entire monorepo could fail to install or run if workspaces don't function correctly. This blocks ALL development work.

**Affected Components:**
- Root `package.json` with workspaces configuration
- All workspace packages (`apps/*`, `packages/*`)
- Dependency hoisting and resolution
- `npm run dev` concurrent execution

**Mitigation Strategy:**
1. **Preventive Actions:**
   - Add `.nvmrc` file specifying Node.js 20.10.0 (includes npm 10.2.4+)
   - Document npm version requirement prominently in README prerequisites
   - Add npm version check to installation steps
   - Include troubleshooting section for version mismatches

2. **Detective Controls:**
   - Test installation on clean machine with exact npm version
   - Verify workspace hoisting with `npm ls` command
   - Check for duplicate dependencies across workspaces

3. **Corrective Actions:**
   - Provide clear upgrade instructions: `npm install -g npm@latest`
   - Link to Node.js 20 LTS installation guide
   - Document how to use `nvm` for version management

**Testing Requirements:**
- ✅ Install test on machine with npm 10.2.4+
- ✅ Verify `npm install` at root installs all workspace dependencies
- ✅ Check `node_modules` structure shows proper hoisting
- ⚠️ Attempt install with npm 9.x (should document expected behavior)

**Residual Risk:** Low - With `.nvmrc` and documentation, risk reduces to user education.

**Owner:** Dev implementing Story 1.1  
**Timeline:** Before initial commit

---

## Medium Risks

### 2. TECH-002: Path Alias Resolution Conflicts

**Score: 4 (Medium)** | Probability: Medium (2) × Impact: Medium (2)

**Risk Description:**  
Using `@` as path alias in Vite may conflict with scoped npm packages (`@spa-hackathon/*`, `@vitejs/*`). Could cause import resolution failures or IDE confusion.

**Mitigation:**
- Use `@/` prefix (with trailing slash) for all path aliases
- Configure consistently in both `vite.config.ts` and `tsconfig.json`
- Test imports in both dev mode and production build
- Verify IDE autocomplete recognizes alias

**Testing Requirements:**
- Create test component at `frontend/src/components/ui/TestButton.tsx`
- Import using `import TestButton from '@/components/ui/TestButton'`
- Verify Vite dev server resolves correctly
- Verify production build (`npm run build`) resolves correctly
- Check TypeScript compiler has no errors

**Residual Risk:** Very Low - This is a standard Vite pattern used widely.

---

### 3. OPS-001: Concurrent Script Execution Platform Differences

**Score: 4 (Medium)** | Probability: Medium (2) × Impact: Medium (2)

**Risk Description:**  
`concurrently` package may behave differently on Windows PowerShell vs Unix bash. Quote escaping, color output, and signal handling vary.

**Mitigation:**
- Use npm workspace commands (`-w` flag) which are cross-platform
- Escape quotes for Windows: `\"npm run dev -w @spa-hackathon/frontend\"`
- Test on both Windows and Unix environments
- Document platform-specific issues in README troubleshooting

**Testing Requirements:**
- **Windows PowerShell:** Run `npm run dev` and verify both apps start
- **Unix/macOS bash:** Run `npm run dev` and verify both apps start
- Verify both app logs appear in terminal output
- Test `Ctrl+C` terminates both processes cleanly

**Residual Risk:** Low - `concurrently` is mature and widely used.

---

## Low Risks

### 4. TECH-003: TypeScript Strict Mode Breaking Existing Patterns

**Score: 3 (Low)** | Probability: Low (1) × Impact: High (3)

Fresh setup with no existing code, so strict mode won't break anything initially. Future stories must comply with strict type checking.

**Mitigation:** Configure strict mode from start (already in story tasks). Document strict mode requirements in Dev Notes.

---

### 5. TECH-004: ESLint/Prettier Config Package Resolution

**Score: 2 (Low)** | Probability: Low (1) × Impact: Medium (2)

Standard npm workspaces pattern for shared configs. Resolution should work with explicit workspace references.

**Mitigation:** Use `@spa-hackathon/eslint-config` package name, install as dependency in consuming packages.

---

### 6. OPS-002: .gitignore Gaps Leading to Committed Secrets

**Score: 2 (Low)** | Probability: Low (1) × Impact: Medium (2)

Comprehensive .gitignore is planned in story. Risk is developer accidentally committing `.env` before .gitignore takes effect.

**Mitigation:** Create .gitignore FIRST (Task 1.3) before any other files. Include all `.env*` patterns.

---

### 7. DATA-001: Missing .env Files Causing Silent Failures

**Score: 2 (Low)** | Probability: Low (1) × Impact: Medium (2)

Backend uses `PORT=3000` default, so missing .env won't break startup. Frontend uses Vite defaults.

**Mitigation:** Provide `.env.example` with all variables. Document setup in README.

---

## Risk Distribution

### By Category
- **Technical (TECH):** 4 risks (1 high, 1 medium, 2 low)
- **Operational (OPS):** 2 risks (1 medium, 1 low)
- **Data (DATA):** 1 risk (1 low)
- **Security (SEC):** 0 risks
- **Performance (PERF):** 0 risks
- **Business (BUS):** 0 risks

### By Component
- **Monorepo Infrastructure:** 3 risks (TECH-001, OPS-001, OPS-002)
- **Frontend (Vite):** 1 risk (TECH-002)
- **Backend (Express):** 1 risk (DATA-001)
- **Shared Configs:** 1 risk (TECH-004)
- **TypeScript:** 1 risk (TECH-003)

### Risk Score Calculation

```
Base Score:        100
High risks:        1 × 10 = -10
Medium risks:      2 × 5  = -10
Low risks:         4 × 2  = -8
----------------------------
Calculated Score:  72/100

Adjusted Score:    85/100
(Considering well-established tooling, comprehensive story tasks, no custom integrations)
```

---

## Risk-Based Testing Strategy

### Priority 1: High Risk Tests (MUST EXECUTE)

**TECH-001 Verification:**
- [ ] Install on clean Windows machine with Node.js 20 LTS
- [ ] Verify npm version is 10.2.4 or higher
- [ ] Run `npm install` at root
- [ ] Verify workspace packages installed: `npm ls --depth=0`
- [ ] Check for duplicate dependencies across workspaces
- [ ] Verify both apps can import shared packages

### Priority 2: Medium Risk Tests (SHOULD EXECUTE)

**TECH-002 Verification:**
- [ ] Create test component: `frontend/src/components/ui/TestButton.tsx`
- [ ] Add import: `import TestButton from '@/components/ui/TestButton'`
- [ ] Start dev server: `npm run dev -w @spa-hackathon/frontend`
- [ ] Verify no import errors in browser console
- [ ] Build production: `npm run build -w @spa-hackathon/frontend`
- [ ] Verify TypeScript compilation succeeds

**OPS-001 Verification:**
- [ ] Run `npm run dev` from root on Windows PowerShell
- [ ] Verify frontend starts on port 5173
- [ ] Verify backend starts on port 3000
- [ ] Verify both app logs appear in terminal
- [ ] Test `Ctrl+C` stops both processes
- [ ] Repeat on Unix/macOS if available

### Priority 3: Standard Functional Tests (NORMAL COVERAGE)

**All 10 Acceptance Criteria:**
- [ ] AC1: Folder structure matches specification
- [ ] AC2: Frontend app initialized with Vite + React + TS
- [ ] AC3: Backend app initialized with Node + Express + TS
- [ ] AC4: Shared packages created (types, config, utils)
- [ ] AC5: Package.json scripts work (`dev`, `build`, `lint`, `format`)
- [ ] AC6: TypeScript strict mode enabled in both apps
- [ ] AC7: ESLint + Prettier configured with shared configs
- [ ] AC8: .gitignore excludes node_modules, .env, dist, build
- [ ] AC9: README.md exists with setup instructions
- [ ] AC10: Both apps start successfully on specified ports

**Additional Smoke Tests:**
- [ ] TypeScript compilation: `npm run build` (no errors)
- [ ] Linting: `npm run lint` (no errors on fresh setup)
- [ ] Formatting: `npm run format` (runs without errors)
- [ ] Git status: Verify sensitive files excluded
- [ ] Health check: `curl http://localhost:3000/health` returns `{"status":"ok"}`

---

## Risk Acceptance Criteria

### Must Fix Before Story Completion

1. ✅ **Add `.nvmrc` file** - Mitigates TECH-001
2. ✅ **Test concurrent scripts on Windows** - Mitigates OPS-001
3. ✅ **Verify path alias resolution** - Mitigates TECH-002

### Can Complete Story With Mitigation

- TECH-004: ESLint/Prettier config - Verify with `npm run lint` test
- OPS-002: .gitignore - Verify with `git status` test
- DATA-001: .env handling - Verify apps start with defaults

### Accepted Risks (No Further Action)

- TECH-003: TypeScript strict mode - Intentional design choice, future stories comply

---

## Monitoring Requirements Post-Implementation

### Development Phase (During Epic 1)
- Monitor for npm version issues across team
- Track import resolution errors in dev/build
- Collect feedback on Windows vs Unix script behavior

### Future Stories
- Ensure new code complies with TypeScript strict mode
- Verify new shared packages resolve correctly
- Update .gitignore for new build artifacts

---

## Risk Review Triggers

Re-assess risk profile if:
- ❌ npm or Node.js version requirements change
- ❌ Additional apps added to monorepo (e.g., mobile app)
- ❌ Migration from npm workspaces to different tool (Turborepo, Nx)
- ❌ Cross-platform compatibility issues reported
- ❌ New shared package types introduced

---

## Recommendations

### For Story Implementation

1. **Order of Execution:** Follow Phase 1-7 sequence in story tasks
   - Phase 1 Task 1.3 (Create .gitignore) BEFORE any other files
   - Phase 1 complete before Phase 2/3 (prevents rework)

2. **Windows-First Testing:** Since user is on Windows, test concurrently scripts early
   - Run `npm run dev` after Phase 5 Task 5.1
   - Validate quote escaping in package.json scripts

3. **Documentation Emphasis:**
   - README "Prerequisites" section MUST list exact versions
   - Add troubleshooting section for common npm/Node version issues
   - Include platform-specific notes (Windows PowerShell vs Unix)

### For Future Stories

4. **TypeScript Discipline:** All new code must pass strict mode
5. **Shared Package Pattern:** Follow `@spa-hackathon/*` naming consistently
6. **Environment Variables:** Use `.env.example` + defaults pattern

---

## Integration with Quality Gate

**Risk Summary for Gate File:**

```yaml
risk_summary:
  totals:
    critical: 0  # score 9
    high: 1      # score 6
    medium: 2    # score 4
    low: 4       # score 2-3
  highest:
    id: TECH-001
    score: 6
    title: 'npm Workspaces version compatibility'
  recommendations:
    must_fix:
      - 'Add .nvmrc file with Node.js 20 LTS'
      - 'Test concurrent scripts on Windows PowerShell'
      - 'Verify path alias resolution in Vite'
    monitor:
      - 'Track npm version issues across team'
      - 'Monitor cross-platform script behavior'
```

**Gate Determination Logic:**
- No Critical Risks (score 9) → Not FAIL
- 1 High Risk (score 6) with clear mitigation → PASS (conditional)
- Conditions met during implementation → PASS
- Conditions not met → Downgrade to CONCERNS

---

## Conclusion

Story 1.1 is **LOW RISK** for implementation. The infrastructure setup uses mature, well-documented tooling (npm workspaces, Vite, Express). The single high-risk item (npm version compatibility) has straightforward mitigation via `.nvmrc` file and documentation.

**Key Success Factors:**
✅ Comprehensive task breakdown (41 subtasks)  
✅ Well-established technology stack  
✅ Clear verification criteria (10 ACs)  
✅ Platform-aware testing (Windows focus)

**Risk Mitigation Ready:** All identified risks have actionable mitigation strategies and test plans.

---

**Risk Profile Reference:** `docs/qa/assessments/1.1-risk-20251028.md`
